<div *ngIf="currentPage=='ROOT'">
    <div *ngIf="invokeByMenu" class="page-header">
        <div class="col-sm">
            <label class="col-form-label">{{title}}</label>
            <button (click)="Close()" class="btn btn-primary btn-sm">Close</button>
            <i *ngIf="loading" class="fa fa-spinner"></i>
        </div>
    </div>
    <div class="page-list">
        <div *ngIf="invokeByMenu" class="page-search">
            <!-- <div class="row">
                <div class="col-sm-5">
                    <div class="form-group row">
                        <label class="col-sm-3 col-form-label col-form-label-sm">Year</label>
                        <div class="col-sm-4">
                            <input type="number" class="form-control form-control-sm" [(ngModel)]="iYear"
                                maxlength="4" />
                        </div>
                        <div class="col-sm-5">
                            <input type="radio" name="mark_mode" id="sperson" [(ngModel)]="report_type"
                                [value]="'SALES PERSON'" />
                            <label class="col-form-label col-form-label-sm" for="sperson">Sales
                                Person</label>&nbsp;&nbsp;
                            <input type="radio" name="mark_mode" id="scustomer" [(ngModel)]="report_type"
                                [value]="'CUSTOMER'" />
                            <label class="col-form-label col-form-label-sm" for="scustomer">Customer</label>
                        </div>
                    </div>
                </div>
                <div class="col-sm-5">
                    <div class="form-group row">
                        <label class="col-sm-3 col-form-label col-form-label-sm">{{report_type=='SALES PERSON'?'Sales
                            Person':'Customer'}}</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control form-control-sm" [(ngModel)]="searchstring"
                                maxlength="100" (blur)="OnBlur('searchstring')" />
                        </div>
                        <div class="col-sm-5">
                            <button [disabled]="loading" (click)="List('NEW','SCREEN')"
                                class="btn btn-primary btn-sm">Search</button>
                            <button [disabled]="loading" *ngIf="bPrint" (click)="List('PRINT', 'EXCEL')"
                                class="btn btn-primary btn-sm">Print</button>
                        </div>
                    </div>
                </div>
                <div class="col-sm-2">
                </div>
            </div> -->
            <div class="row">
                <div class="col-sm-4">
                    <div class="form-group row">
                        <label class="col-sm-3 col-form-label col-form-label-sm">Year</label>
                        <div class="col-sm-3">
                            <input type="number" class="form-control form-control-sm" [(ngModel)]="iYear"
                                maxlength="4" />
                        </div>
                        <label class="col-sm-2 col-form-label col-form-label-sm">Month</label>
                        <div class="col-sm-4">
                            <select class="form-control form-control-sm" [(ngModel)]="iMonth">
                                <option *ngFor="let rec of MonList" [value]="rec.id">{{rec.name}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-sm-3 col-form-label col-form-label-sm">Branch</label>
                        <div class="col-sm-9">
                            <app-autocomplete3 [controlname]="'BRANCH'" [tabletype]="'BRANCH'" [displaycolumn]="'CODE'"
                                [displaydata]="branch_code" (ValueChanged)="LovSelected($event)">
                            </app-autocomplete3>
                        </div>
                    </div>

                </div>
                <div class="col-sm-4">
                    <div class="form-group row">
                        <label class="col-sm-3 col-form-label col-form-label-sm">Type</label>
                        <div class="col-sm-5">
                            <input type="radio" name="mark_mode" id="sperson" [(ngModel)]="report_type"
                                [value]="'SALES PERSON'" />
                            <label class="col-form-label col-form-label-sm" for="sperson">Salesperson</label>
                        </div>
                        <div class="col-sm-4">
                            <input type="radio" name="mark_mode" id="scustomer" [(ngModel)]="report_type"
                                [value]="'CUSTOMER'" />
                            <label class="col-form-label col-form-label-sm" for="scustomer">Customer</label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label
                            class="col-sm-3 col-form-label col-form-label-sm">{{report_type=='CUSTOMER'?'Customer':'Salesperson'}}</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control form-control-sm" [(ngModel)]="searchstring"
                                maxlength="100" (blur)="OnBlur('searchstring')" />
                        </div>
                    </div>

                </div>
                <div class="col-sm-4">
                    <div class="form-group row">
                        <label class="col-sm-3 col-form-label col-form-label-sm">Sort by</label>
                        <div class="col-sm-9">
                            <select class="form-control form-control-sm" [(ngModel)]="sortby">
                                <option [value]="'DEFAULT'">DEFAULT</option>
                                <option [value]="'max(user_branch),user_name'">BRANCH</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-sm-3 col-form-label col-form-label-sm"></label>
                        <div class="col-sm-9">
                            <button [disabled]="loading" (click)="List('NEW','SCREEN')"
                                class="btn btn-primary btn-sm mr-1">Search</button>
                            <button [disabled]="loading" *ngIf="bPrint" (click)="List('PRINT', 'EXCEL')"
                                class="btn btn-primary btn-sm">Print</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="invokeByMenu" class="page-pager">
            <div *ngIf="page_count">
                <ul class="pagination pagination-sm mb-1">
                    <li class="page-item"><a class="page-link">Page {{page_current}}/{{page_count}}
                            (Records-{{page_rowcount}})</a>
                    </li>
                    <li class="page-item"><a class="page-link" (click)="List('FIRST')"><span
                                class="fa fa-backward"></span></a></li>
                    <li class="page-item"><a class="page-link" (click)="List('PREV')"><span
                                class="fa fa-arrow-left"></span></a>
                    </li>
                    <li class="page-item"><a class="page-link" (click)="List('NEXT')"><span
                                class="fa fa-arrow-right"></span></a>
                    </li>
                    <li class="page-item"><a class="page-link" (click)="List('LAST')"><span
                                class="fa fa-forward"></span></a></li>
                </ul>
            </div>
        </div>
        <div *ngIf="search_iMonth=='ALL'" class="page-body table-responsive fixedTableHead my-0 p-0"
            [style.height]="type === 'INVOKE-FRM-CONTACT'?'auto':'calc(100vh - 360px)'">
            <table class="table table-hover table-sm table-bordered table-striped">
                <thead class="page-body-thead">
                    <tr>
                        <th><span *ngIf="search_report_type=='SALES PERSON'">SALESPERSON</span><span
                                *ngIf="search_report_type=='CUSTOMER'">CUSTOMER</span></th>
                        <th *ngIf="search_report_type=='SALES PERSON'">BRANCH</th>
                        <th>JAN</th>
                        <th>FEB</th>
                        <th>MAR</th>
                        <th>APR</th>
                        <th>MAY</th>
                        <th>JUN</th>
                        <th>JUL</th>
                        <th>AUG</th>
                        <th>SEP</th>
                        <th>OCT</th>
                        <th>NOV</th>
                        <th>DEC</th>
                        <th>TOTAL</th>
                    </tr>
                </thead>
                <tbody class="page-body-tbody">
                    <tr *ngFor="let rec of RecordList; let i = index" [class.active]="i == selectedRowIndex"
                        (mousedown)="selectedRowIndex=i">
                        <td>
                            <div class="hlink" (click)="ShowReport(rec,'ALL')">
                                <a>{{rec.user_name}}</a>
                            </div>
                        </td>
                        <td *ngIf="search_report_type=='SALES PERSON'">
                            <div style="color: chocolate;font-weight: bold;">
                                <a>{{rec.user_branch}}</a>
                            </div>
                        </td>

                        <td class="hlink">
                            <div (click)="ShowReport(rec,'JAN',rec.jan)">
                                <a>{{rec.jan>0?rec.jan:null}}</a>
                            </div>
                        </td>
                        <td class="hlink" >
                            <div (click)="ShowReport(rec,'FEB',rec.feb)">
                                <a>{{rec.feb>0?rec.feb:null}}</a>
                            </div>
                        </td>
                        <td class="hlink" >
                            <div (click)="ShowReport(rec,'MAR',rec.mar)">
                                <a>{{rec.mar>0?rec.mar:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'APR',rec.apr)">
                                <a>{{rec.apr>0?rec.apr:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div  (click)="ShowReport(rec,'MAY',rec.may)">
                                <a>{{rec.may>0?rec.may:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div  (click)="ShowReport(rec,'JUN',rec.jun)">
                                <a>{{rec.jun>0?rec.jun:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'JUL',rec.jul)">
                                <a>{{rec.jul>0?rec.jul:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'AUG',rec.aug)">
                                <a>{{rec.aug>0?rec.aug:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'SEP',rec.sep)">
                                <a>{{rec.sep>0?rec.sep:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'OCT',rec.oct)">
                                <a>{{rec.oct>0?rec.oct:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'NOV',rec.nov)">
                                <a>{{rec.nov>0?rec.nov:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'DEC',rec.dec)">
                                <a>{{rec.dec>0?rec.dec:null}}</a>
                            </div>
                        </td>
                        <td class="hlink">
                            <div (click)="ShowReport(rec,'ALL')">
                                <a>{{rec.total>0?rec.total:null}}</a>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div *ngIf="search_iMonth!='ALL'" class="page-body table-responsive fixedTableHead my-0 p-0"
            [style.height]="type === 'INVOKE-FRM-CONTACT'?'auto':'calc(100vh - 360px)'">
            <table class="table table-hover table-sm table-bordered table-striped">
                <thead class="page-body-thead">
                    <tr>

                        <th><span *ngIf="search_report_type=='SALES PERSON'">SALESPERSON</span><span
                                *ngIf="search_report_type=='CUSTOMER'">CUSTOMER</span></th>
                        <th *ngIf="search_report_type=='SALES PERSON'">BRANCH</th>
                        <th>{{RecordCaption.d1_caption}}</th>
                        <th>{{RecordCaption.d2_caption}}</th>
                        <th>{{RecordCaption.d3_caption}}</th>
                        <th>{{RecordCaption.d4_caption}}</th>
                        <th>{{RecordCaption.d5_caption}}</th>
                        <th>{{RecordCaption.d6_caption}}</th>
                        <th>{{RecordCaption.d7_caption}}</th>
                        <th>{{RecordCaption.d8_caption}}</th>
                        <th>{{RecordCaption.d9_caption}}</th>
                        <th>{{RecordCaption.d10_caption}}</th>
                        <th>{{RecordCaption.d11_caption}}</th>
                        <th>{{RecordCaption.d12_caption}}</th>
                        <th>{{RecordCaption.d13_caption}}</th>
                        <th>{{RecordCaption.d14_caption}}</th>
                        <th>{{RecordCaption.d15_caption}}</th>
                        <th>{{RecordCaption.d16_caption}}</th>
                        <th>{{RecordCaption.d17_caption}}</th>
                        <th>{{RecordCaption.d18_caption}}</th>
                        <th>{{RecordCaption.d19_caption}}</th>
                        <th>{{RecordCaption.d20_caption}}</th>
                        <th>{{RecordCaption.d21_caption}}</th>
                        <th>{{RecordCaption.d22_caption}}</th>
                        <th>{{RecordCaption.d23_caption}}</th>
                        <th>{{RecordCaption.d24_caption}}</th>
                        <th>{{RecordCaption.d25_caption}}</th>
                        <th>{{RecordCaption.d26_caption}}</th>
                        <th *ngIf="totdays>=27">{{RecordCaption.d27_caption}}</th>
                        <th *ngIf="totdays>=28">{{RecordCaption.d28_caption}}</th>
                        <th *ngIf="totdays>=29">{{RecordCaption.d29_caption}}</th>
                        <th *ngIf="totdays>=30">{{RecordCaption.d30_caption}}</th>
                        <th *ngIf="totdays>=31">{{RecordCaption.d31_caption}}</th>
                        <th>TOTAL</th>
                    </tr>
                </thead>
                <tbody class="page-body-tbody">
                    <tr *ngFor="let rec of RecordList; let i = index" [class.active]="i == selectedRowIndex"
                        (mousedown)="selectedRowIndex=i">
                        <td>
                            <div class="hlink" (click)="ShowReport(rec,'ALL')">
                                <a>{{rec.user_name}}</a>
                            </div>
                        </td>
                        <td *ngIf="search_report_type=='SALES PERSON'">
                            <div style="color: chocolate;font-weight: bold;">
                                <a>{{rec.user_branch}}</a>
                            </div>
                        </td>
                        <td class="hlink" (click)="ShowReport(rec,'01',rec.d1)">{{rec.d1>0?rec.d1:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'02',rec.d2)">{{rec.d2>0?rec.d2:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'03',rec.d3)">{{rec.d3>0?rec.d3:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'04',rec.d4)">{{rec.d4>0?rec.d4:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'05',rec.d5)">{{rec.d5>0?rec.d5:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'06',rec.d6)">{{rec.d6>0?rec.d6:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'07',rec.d7)">{{rec.d7>0?rec.d7:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'08',rec.d8)">{{rec.d8>0?rec.d8:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'09',rec.d9)">{{rec.d9>0?rec.d9:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'10',rec.d10)">{{rec.d10>0?rec.d10:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'11',rec.d11)">{{rec.d11>0?rec.d11:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'12',rec.d12)">{{rec.d12>0?rec.d12:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'13',rec.d13)">{{rec.d13>0?rec.d13:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'14',rec.d14)">{{rec.d14>0?rec.d14:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'15',rec.d15)">{{rec.d15>0?rec.d15:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'16',rec.d16)">{{rec.d16>0?rec.d16:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'17',rec.d17)">{{rec.d17>0?rec.d17:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'18',rec.d18)">{{rec.d18>0?rec.d18:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'19',rec.d19)">{{rec.d19>0?rec.d19:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'20',rec.d20)">{{rec.d20>0?rec.d20:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'21',rec.d21)">{{rec.d21>0?rec.d21:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'22',rec.d22)">{{rec.d22>0?rec.d22:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'23',rec.d23)">{{rec.d23>0?rec.d23:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'24',rec.d24)">{{rec.d24>0?rec.d24:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'25',rec.d25)">{{rec.d25>0?rec.d25:null}}</td>
                        <td class="hlink" (click)="ShowReport(rec,'26',rec.d26)">{{rec.d26>0?rec.d26:null}}</td>
                        <td *ngIf="totdays>=27" class="hlink" (click)="ShowReport(rec,'27',rec.d27)">{{rec.d27>0?rec.d27:null}}
                        </td>
                        <td *ngIf="totdays>=28" class="hlink" (click)="ShowReport(rec,'28',rec.d28)">{{rec.d28>0?rec.d28:null}}
                        </td>
                        <td *ngIf="totdays>=29" class="hlink" (click)="ShowReport(rec,'29',rec.d29)">{{rec.d29>0?rec.d29:null}}
                        </td>
                        <td *ngIf="totdays>=30" class="hlink" (click)="ShowReport(rec,'30',rec.d30)">{{rec.d30>0?rec.d30:null}}
                        </td>
                        <td *ngIf="totdays>=31" class="hlink" (click)="ShowReport(rec,'31',rec.d31)">{{rec.d31>0?rec.d31:null}}
                        </td>

                        <td>
                            <div class="hlink" (click)="ShowReport(rec,'ALL',rec.total)">
                                <a>{{rec.total>0?rec.total:null}}</a>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div *ngIf="invokeByMenu" class="page-pager">
            <div *ngIf="page_count">
                <ul class="pagination pagination-sm mb-1">
                    <li class="page-item"><a class="page-link">Page {{page_current}}/{{page_count}}
                            (Records-{{page_rowcount}})</a>
                    </li>
                    <li class="page-item"><a class="page-link" (click)="List('FIRST')"><span
                                class="fa fa-backward"></span></a></li>
                    <li class="page-item"><a class="page-link" (click)="List('PREV')"><span
                                class="fa fa-arrow-left"></span></a>
                    </li>
                    <li class="page-item"><a class="page-link" (click)="List('NEXT')"><span
                                class="fa fa-arrow-right"></span></a>
                    </li>
                    <li class="page-item"><a class="page-link" (click)="List('LAST')"><span
                                class="fa fa-forward"></span></a></li>
                </ul>
            </div>
        </div>
    </div>
</div>


<div *ngIf="currentPage=='VISIT-REPORT-CHILD'">
    <app-visitreportchild [menuid]="menuid" [parentData]="ChildRecord" (PageChanged)="pageChanged($event)">
    </app-visitreportchild>
</div>